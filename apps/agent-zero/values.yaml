app-template:
  controllers:
    main:
      annotations:
        reloader.stakater.com/auto: "true"
      containers:
        main:
          image:
            repository: agent0ai/agent-zero
            tag: latest
          env:
            TZ: America/Chicago
            # Ollama Base URL
            OLLAMA_BASE_URL: "http://ollama.ollama.svc.cluster.local:11434"
            # Chat Model Configuration
            CHAT_MODEL_PROVIDER: "ollama"
            CHAT_MODEL_NAME: "qwen3-coder:30b"
            CHAT_MODEL_API_URL: "http://ollama.ollama.svc.cluster.local:11434"
            # Utility Model Configuration (for memory organization, summarization)
            UTILITY_MODEL_PROVIDER: "ollama"
            UTILITY_MODEL_NAME: "qwen3-coder:30b"
            UTILITY_MODEL_API_URL: "http://ollama.ollama.svc.cluster.local:11434"
            # Embedding Model Configuration (for RAG/memory)
            EMBEDDING_MODEL_PROVIDER: "ollama"
            EMBEDDING_MODEL_NAME: "nomic-embed-text:latest"
            EMBEDDING_MODEL_API_URL: "http://ollama.ollama.svc.cluster.local:11434"
            # Allowed Origins for CORS
            ALLOWED_ORIGINS: "https://agent-zero.eaglepass.io"
            # NOTE: Ensure models are pulled on Ollama:
            #   ollama pull qwen3-coder:30b
            #   ollama pull nomic-embed-text:latest
      pod:
        annotations:
          operator.1password.io/item-path: "vaults/homelab/items/agent-zero"
          operator.1password.io/item-name: "secrets"

  service:
    main:
      controller: main
      ports:
        http:
          port: 80

  ingress:
    main:
      className: nginx
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
      hosts:
        - host: agent-zero.eaglepass.io
          paths:
            - path: /
              service:
                identifier: main
                port: http
      tls:
        - hosts:
            - agent-zero.eaglepass.io
          secretName: agent-zero-tls

  persistence:
    data:
      type: nfs
      server: 10.0.40.3
      path: /mnt/user/agent-zero
      advancedMounts:
        main:
          main:
            - path: /a0/usr
